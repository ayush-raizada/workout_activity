<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Activity Tracker">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="./manifest.json">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9InVybCgjZ3JhZGllbnQwKSIvPgo8ZGVmcz4KPGXYZ2VTQPcmRyYWRpZW50IGlkPSJncmFkaWVudDAiIHgxPSIwIiB5MT0iMCIgeDI9IjE5MiIgeTI9IjE5MiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSIjNjY3ZWVhIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzc2NGJhMiIvPgo8L2xpbmVhckdyYWRpZW50Pgo8L2RlZnM+CjxyZWN0IHg9IjQwIiB5PSI0MCIgd2lkdGg9IjExMiIgaGVpZ2h0PSIxMTIiIHJ4PSI4IiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjkiLz4KPHA+PCEtLSBDYWxlbmRhciBncmlkIC0tPgo8cmVjdCB4PSI0OCIgeT0iNDgiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzY2N2VlYSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9Ijc2IiB5PSI0OCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjNjY3ZWVhIiBmaWxsLW9wYWNpdHk9IjAuMyIvPgo8IS0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjEwNCIgeT0iNDgiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzY2N2VlYSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjEzMiIgeT0iNDgiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzY2N2VlYSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjQ4IiB5PSI3NiIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjNjY3ZWVhIiBmaWxsLW9wYWNpdHk9IjAuMyIvPgo8IS0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9Ijc2IiB5PSI3NiIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjhhNzQ1IiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8IS0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjEwNCIgeT0iNzYiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iI2ZmYzEwNyIgZmlsbC1vcGFjaXR5PSIwLjgiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjEzMiIgeT0iNzYiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzY2N2VlYSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjQ4IiB5PSIxMDQiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzY2N2VlYSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9Ijc2IiB5PSIxMDQiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzI4YTc0NSIgZmlsbC1vcGFjaXR5PSIwLjgiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjEwNCIgeT0iMTA0IiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIGZpbGw9IiNmZmMxMDciIGZpbGwtb3BhY2l0eT0iMC44Ii8+CjwhLS0gQ2FsZW5kYXIgZ3JpZCAtLT4KPHJlY3QgeD0iMTMyIiB5PSIxMDQiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzY2N2VlYSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjQ4IiB5PSIxMzIiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzY2N2VlYSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPCEtLSBDaWxlbmRhciBncmlkIC0tPgo8cmVjdCB4PSI3NiIgeT0iMTMyIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIGZpbGw9IiM2NjdlZWEiIGZpbGwtb3BhY2l0eT0iMC4zIi8+CjwhLS0gQ2FsZW5kYXIgZ3JpZCAtLT4KPHJlY3QgeD0iMTA0IiB5PSIxMzIiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgZmlsbD0iIzY2N2VlYSIgZmlsbC1vcGFjaXR5PSIwLjMiLz4KPHA+PC0tIENhbGVuZGFyIGdyaWQgLS0+CjxyZWN0IHg9IjEzMiIgeT0iMTMyIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIGZpbGw9IiM2NjdlZWEiIGZpbGwtb3BhY2l0eT0iMC4zIi8+Cjwvc3ZnPgo=">
    <title>Daily Activity Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            min-height: 100dvh;
            padding: env(safe-area-inset-top, 10px) env(safe-area-inset-right, 10px) env(safe-area-inset-bottom, 10px) env(safe-area-inset-left, 10px);
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 20px);
            min-height: 600px;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px;
            text-align: center;
            flex-shrink: 0;
        }

        .header h1 {
            font-size: 1.8em;
            font-weight: 300;
            margin-bottom: 5px;
        }

        .header .subtitle {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-height: 0;
            overflow: hidden;
            position: relative;
        }

        /* =========================
           MOBILE-FIRST LAYOUT
           ========================= */

        /* Mobile: Toggle button for master activities */
        .mobile-sidebar-toggle {
            position: fixed;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            z-index: 1001;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .mobile-sidebar-toggle:active {
            transform: translateY(-50%) scale(0.95);
            background: #5a6fd8;
        }

        .mobile-sidebar-toggle.open {
            left: 260px;
            background: #dc3545;
        }

        /* Mobile: Slide-out master activities sidebar */
        .master-activities {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100vh;
            background: #f8f9fa;
            z-index: 1000;
            transition: left 0.3s ease;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            padding: 80px 15px 15px 15px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .master-activities.open {
            left: 0;
        }

        /* Mobile: Overlay when sidebar is open */
        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .mobile-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .activities-container {
            display: block;
            padding: 0;
        }

        .activity-group {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            width: 100%;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .activity-group-header {
            font-weight: 600;
            color: #495057;
            margin-bottom: 12px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .group-name {
            flex: 1;
        }

        .group-actions {
            display: flex;
            gap: 8px;
        }

        .edit-btn, .delete-btn, .add-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            font-size: 14px;
            transition: background-color 0.2s;
            min-height: 44px;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .edit-btn:hover, .edit-btn:active {
            background: #007bff;
            color: white;
        }

        .delete-btn:hover, .delete-btn:active {
            background: #dc3545;
            color: white;
        }

        .add-btn {
            background: #28a745;
            color: white;
            margin-top: 10px;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.85em;
            width: 100%;
            min-height: 48px;
        }

        .add-btn:hover, .add-btn:active {
            background: #218838;
        }

        .add-group-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            margin: 15px;
            min-height: 48px;
            width: calc(100% - 30px);
        }

        .add-group-btn:hover, .add-group-btn:active {
            background: #5a6fd8;
        }

        .activity-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 15px;
            margin: 8px 0;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95em;
            transition: transform 0.2s, box-shadow 0.2s;
            user-select: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 48px;
            touch-action: manipulation;
            position: relative;
        }

        .activity-content {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .activity-name {
            flex: 1;
            font-weight: 500;
        }

        .activity-score {
            font-size: 0.8em;
            opacity: 0.9;
            margin-left: 8px;
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: 12px;
        }

        .activity-actions {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }

        .activity-edit-btn, .activity-delete-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            border-radius: 6px;
            width: 32px;
            height: 32px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 44px;
            min-width: 44px;
        }

        .activity-edit-btn:hover, .activity-edit-btn:active {
            background: rgba(255, 255, 255, 0.3);
        }

        .activity-delete-btn:hover, .activity-delete-btn:active {
            background: rgba(220, 53, 69, 0.8);
        }

        /* Dragging feedback */
        .activity-item.dragging {
            transform: scale(1.05);
            opacity: 0.8;
            z-index: 1000;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }

        /* Main dashboard area */
        .main-dashboard {
            flex: 1;
            padding: 15px;
            min-height: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .dashboard-header {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            flex-shrink: 0;
        }

        .dashboard-header h2 {
            color: #2c3e50;
            font-size: 1.4em;
            text-align: center;
        }

        .view-toggle {
            display: none; /* Hidden on mobile - daily view only */
            background: #e9ecef;
            border-radius: 25px;
            padding: 4px;
            justify-content: center;
        }

        .toggle-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 20px;
            background: transparent;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            font-size: 0.9em;
            min-height: 48px;
        }

        .toggle-btn.active {
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            color: #2c3e50;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
            flex-shrink: 0;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            border-left: 4px solid #667eea;
        }

        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.8em;
        }

        /* Calendar views */
        .calendar-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
            flex: 1;
            min-height: 0;
            display: flex;
            flex-direction: column;
        }

        .calendar-header {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            flex-direction: column;
            gap: 15px;
            flex-shrink: 0;
        }

        .week-navigation {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .nav-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            min-height: 48px;
            min-width: 48px;
        }

        .nav-btn:hover, .nav-btn:active {
            background: #5a6fd8;
        }

        .current-week {
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
            font-size: 0.9em;
        }

        /* Mobile-optimized calendar */
        .calendar-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding: 15px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            flex: 1;
        }

        .day-cell {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px;
            min-height: 120px;
            transition: all 0.2s;
        }

        .day-cell.drag-over {
            background: #e3f2fd;
            border-color: #2196f3;
            transform: scale(1.02);
        }

        .day-header-mobile {
            font-weight: 600;
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.1em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .day-date-mobile {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 0.8em;
        }

        .day-header {
            display: none; /* Hidden on mobile by default */
        }

        .day-activities {
            min-height: 80px;
        }

        .day-activity {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 10px 12px;
            margin: 6px 0;
            border-radius: 8px;
            font-size: 0.85em;
            position: relative;
            cursor: pointer;
            border: 2px solid transparent;
            min-height: 48px;
            touch-action: manipulation;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .day-activity.completed {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border-color: #155724;
        }

        .day-activity.scheduled {
            background: linear-gradient(135deg, #ffc107 0%, #ff8f00 100%);
            color: #333;
            border-color: #856404;
        }

        .day-activity:active {
            transform: scale(0.98);
        }

        .activity-content-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .activity-info {
            flex: 1;
            min-width: 0;
        }

        .activity-title {
            font-weight: 600;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .activity-meta {
            font-size: 0.75em;
            opacity: 0.8;
            display: flex;
            gap: 8px;
        }

        .activity-status {
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.7em;
        }

        .activity-controls {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }

        .control-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: inherit;
            border-radius: 6px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
            touch-action: manipulation;
            min-height: 44px;
            min-width: 44px;
        }

        .control-btn:active {
            background: rgba(255,255,255,0.4);
        }

        /* Daily view */
        .daily-view {
            display: none;
        }

        .daily-view.active {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .daily-header {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            flex-shrink: 0;
        }

        .daily-date-picker {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .date-input {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            min-height: 48px;
            text-align: center;
        }

        .daily-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            flex: 1;
            overflow-y: auto;
        }

        .daily-activities {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
            min-height: 200px;
        }

        .daily-activities h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .drop-zone {
            min-height: 150px;
            border: 2px dashed #ccc;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            color: #6c757d;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
        }

        .drop-zone.drag-over {
            border-color: #2196f3;
            background: #e3f2fd;
            color: #1976d2;
            transform: scale(1.02);
        }

        .drop-zone.has-activities {
            border: none;
            background: transparent;
            text-align: left;
            padding: 0;
            display: block;
        }

        /* Weekly view */
        .weekly-view {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .weekly-view.active {
            display: flex;
        }

        /* Empty state */
        .empty-calendar {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            text-align: center;
            color: #6c757d;
            min-height: 200px;
        }

        .empty-calendar-icon {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* =========================
           DESKTOP LAYOUT
           ========================= */

        @media (min-width: 1024px) {
            .container {
                height: calc(100vh - 40px);
                max-width: none;
            }

            .header h1 {
                font-size: 2.5em;
            }

            .header .subtitle {
                font-size: 1.1em;
            }

            .main-content {
                flex-direction: row !important;
                height: 100%;
            }

            /* Desktop: Vertical sidebar - Fixed */
            .master-activities {
                width: 320px !important;
                min-width: 320px !important;
                max-width: 320px !important;
                height: 100% !important;
                max-height: none !important;
                border-right: 1px solid #e9ecef !important;
                border-bottom: none !important;
                padding: 15px !important;
                overflow-y: auto !important;
                overflow-x: hidden !important;
                flex-shrink: 0 !important;
                display: block !important;
                visibility: visible !important;
                background: #f8f9fa !important;
            }

            .activities-container {
                display: block !important;
                padding: 0 !important;
                min-width: auto !important;
            }

            .activity-group {
                min-width: auto !important;
                width: 100% !important;
                margin-bottom: 15px !important;
                flex-shrink: 0 !important;
            }

            .add-group-btn {
                width: 100% !important;
                margin: 15px 0 0 0 !important;
            }

            /* Desktop: Main dashboard */
            .main-dashboard {
                flex: 1 !important;
                padding: 20px !important;
                min-width: 0 !important;
                overflow: hidden !important;
            }

            .dashboard-header {
                flex-direction: row !important;
                justify-content: space-between !important;
                align-items: center !important;
            }

            .dashboard-header h2 {
                text-align: left !important;
                font-size: 1.8em !important;
            }

            .view-toggle {
                width: auto !important;
                justify-content: flex-end !important;
            }

            .toggle-btn {
                flex: none !important;
                min-width: 120px !important;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
                gap: 15px !important;
                margin-bottom: 30px !important;
            }

            .stat-card {
                padding: 20px !important;
            }

            .stat-number {
                font-size: 2em !important;
            }

            .stat-label {
                font-size: 0.9em !important;
            }

            /* Desktop: Grid calendar */
            .calendar-grid {
                display: grid !important;
                grid-template-columns: repeat(7, 1fr) !important;
                gap: 0 !important;
                padding: 0 !important;
                overflow: visible !important;
                flex: 1 !important;
                min-height: 0 !important;
            }

            .day-header {
                display: block !important;
                background: #f8f9fa !important;
                padding: 15px 10px !important;
                text-align: center !important;
                font-weight: 600 !important;
                color: #495057 !important;
                border-bottom: 1px solid #e9ecef !important;
            }

            .day-cell {
                min-height: 150px !important;
                padding: 10px !important;
                border-right: 1px solid #e9ecef !important;
                border-bottom: 1px solid #e9ecef !important;
                border-radius: 0 !important;
                margin: 0 !important;
                background: white !important;
                border: 2px solid #e9ecef !important;
            }

            .day-cell:last-child {
                border-right: none !important;
            }

            .day-header-mobile {
                display: none !important;
            }

            .day-date {
                display: block !important;
                font-weight: 600 !important;
                color: #495057 !important;
                margin-bottom: 8px !important;
                font-size: 0.9em !important;
            }

            .day-activities {
                min-height: 100px !important;
            }

            .day-activity {
                padding: 6px 10px !important;
                margin: 3px 0 !important;
                border-radius: 4px !important;
                font-size: 0.8em !important;
                min-height: auto !important;
            }

            .activity-controls {
                opacity: 0 !important;
                transition: opacity 0.2s !important;
            }

            .day-activity:hover .activity-controls {
                opacity: 1 !important;
            }

            .control-btn {
                width: 24px !important;
                height: 24px !important;
                min-width: 24px !important;
                min-height: 24px !important;
                font-size: 10px !important;
            }

            /* Desktop: Daily view adjustments */
            .daily-content {
                flex-direction: row !important;
                gap: 30px !important;
            }

            .daily-activities {
                flex: 1 !important;
            }

            .calendar-header {
                flex-direction: row !important;
                padding: 15px 20px !important;
            }

            .week-navigation {
                justify-content: flex-start !important;
            }

            /* Desktop: Hide actions until hover */
            .group-actions {
                opacity: 0 !important;
                transition: opacity 0.2s !important;
            }

            .activity-group:hover .group-actions {
                opacity: 1 !important;
            }

            .activity-actions {
                opacity: 0 !important;
                transition: opacity 0.2s !important;
            }

            .activity-item:hover .activity-actions {
                opacity: 1 !important;
            }

            /* Desktop: Hover states */
            .activity-item:hover {
                transform: translateY(-2px) !important;
                box-shadow: 0 4px 8px rgba(0,0,0,0.2) !important;
            }

            .edit-btn:hover, .delete-btn:hover, .add-btn:hover, .add-group-btn:hover {
                transform: translateY(-1px) !important;
            }

            /* Ensure calendar container is flexible */
            .calendar-container {
                display: flex !important;
                flex-direction: column !important;
                flex: 1 !important;
                min-height: 0 !important;
                overflow: hidden !important;
            }

            .weekly-view {
                display: flex !important;
                flex-direction: column !important;
                flex: 1 !important;
                min-height: 0 !important;
            }

            .weekly-view.active {
                display: flex !important;
            }
        }

        /* =========================
           TABLET LAYOUT
           ========================= */

        @media (min-width: 768px) and (max-width: 1023px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .activity-group {
                min-width: 320px;
            }

            .calendar-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
                padding: 15px;
            }

            .day-header-mobile {
                font-size: 1em;
            }

            .day-cell {
                min-height: 180px;
            }

            /* Show both mobile header and activities */
            .day-header {
                display: none;
            }
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 25px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .modal-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c3e50;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
            min-height: 44px;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close:hover, .close:active {
            color: #000;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #495057;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s;
            min-height: 48px;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 25px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s;
            min-height: 48px;
            min-width: 100px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover, .btn-primary:active {
            background: #5a6fd8;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover, .btn-secondary:active {
            background: #5a6268;
        }

        /* Status completion */
        .completion-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .status-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .status-option {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            font-weight: 500;
            min-height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .status-option.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .status-option.scheduled.selected {
            border-color: #ffc107;
            background: #ffc107;
            color: #333;
        }

        .status-option.completed.selected {
            border-color: #28a745;
            background: #28a745;
            color: white;
        }

        .score-input-group {
            display: none;
        }

        .score-input-group.active {
            display: block;
        }

        .current-score {
            font-weight: 600;
            color: #28a745;
        }

        /* PWA install banner */
        .install-banner {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 15px;
            text-align: center;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            display: none;
        }

        .install-banner.show {
            transform: translateY(0);
            display: block;
        }

        .install-banner button {
            background: white;
            color: #28a745;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            margin: 0 10px;
            cursor: pointer;
            font-weight: 600;
            touch-action: manipulation;
            min-height: 44px;
        }

        .install-banner .close-banner {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        /* Small mobile adjustments */
        @media (max-width: 480px) {
            .container {
                height: 100vh;
                border-radius: 0;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .activity-group {
                min-width: 250px;
            }

            .modal-content {
                margin: 5% auto;
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Daily Activity Tracker</h1>
            <div class="subtitle">Track your weekly progress and stay organized</div>
        </div>

        <!-- Mobile sidebar toggle button -->
        <button class="mobile-sidebar-toggle" id="mobileToggle" onclick="toggleMobileSidebar()">‚ò∞</button>

        <!-- Mobile overlay -->
        <div class="mobile-overlay" id="mobileOverlay" onclick="closeMobileSidebar()"></div>

        <div class="main-content">
            <!-- Master activities - responsive layout -->
            <div class="master-activities" id="masterActivities">
                <div class="activities-container" id="activitiesContainer">
                    <!-- Groups will be generated by JavaScript -->
                </div>
                <button class="add-group-btn" onclick="openGroupModal()">+ Add New Group</button>
            </div>

            <div class="main-dashboard">
                <div class="dashboard-header">
                    <h2>Activity Dashboard</h2>
                    <div class="view-toggle">
                        <button class="toggle-btn active" onclick="switchView('weekly')">Weekly View</button>
                        <button class="toggle-btn" onclick="switchView('daily')">Daily View</button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalDaysWorked">0</div>
                        <div class="stat-label">Days Worked</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="weeklyCompletedScore">0</div>
                        <div class="stat-label">Weekly Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completedActivities">0</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="scheduledActivities">0</div>
                        <div class="stat-label">Scheduled</div>
                    </div>
                </div>

                <div class="weekly-view active">
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <div class="week-navigation">
                                <button class="nav-btn" onclick="previousWeek()">‚Üê</button>
                                <div class="current-week" id="currentWeek">Current Week</div>
                                <button class="nav-btn" onclick="nextWeek()">‚Üí</button>
                            </div>
                            <button class="nav-btn" onclick="goToToday()">Today</button>
                        </div>
                        <div class="calendar-grid" id="calendarGrid">
                            <!-- Calendar will be generated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="daily-view">
                    <div class="daily-header">
                        <h3>Daily Activities</h3>
                        <div class="daily-date-picker">
                            <label for="dailyDate">Select Date:</label>
                            <input type="date" id="dailyDate" class="date-input" onchange="loadDailyView()">
                        </div>
                    </div>
                    <div class="daily-content">
                        <div class="daily-activities">
                            <h3>Planned Activities</h3>
                            <div class="drop-zone" id="dailyDropZone">
                                Drag activities here for the selected day
                            </div>
                        </div>
                        <div class="daily-activities">
                            <h3>Activity Summary</h3>
                            <div id="dailySummary">
                                <p>Select a date to view activity summary</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PWA Install Banner -->
    <div id="installBanner" class="install-banner">
        <div>üì± Install Activity Tracker as an app for the best experience!</div>
        <div style="margin-top: 10px;">
            <button onclick="installPWA()">Install App</button>
            <button class="close-banner" onclick="dismissInstallBanner()">Not Now</button>
        </div>
    </div>

    <!-- Modals -->
    <!-- Group Modal -->
    <div id="groupModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="groupModalTitle">Add New Group</h2>
                <span class="close" onclick="closeModal('groupModal')">&times;</span>
            </div>
            <form id="groupForm">
                <div class="form-group">
                    <label class="form-label" for="groupName">Group Name:</label>
                    <input type="text" id="groupName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="groupDefaultScore">Default Points per Activity:</label>
                    <input type="number" id="groupDefaultScore" class="form-input" value="10" min="1" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('groupModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Group</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Activity Modal -->
    <div id="activityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="activityModalTitle">Add New Activity</h2>
                <span class="close" onclick="closeModal('activityModal')">&times;</span>
            </div>
            <form id="activityForm">
                <div class="form-group">
                    <label class="form-label" for="activityName">Activity Name:</label>
                    <input type="text" id="activityName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="activityScore">Points:</label>
                    <input type="number" id="activityScore" class="form-input" value="10" min="1" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('activityModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Activity</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notes/Status Modal -->
    <div id="notesModal" class="modal notes-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="notesModalTitle">Activity Details</h2>
                <span class="close" onclick="closeModal('notesModal')">&times;</span>
            </div>
            <form id="notesForm">
                <div class="completion-section">
                    <h4>Activity Status</h4>
                    <div class="status-toggle">
                        <div class="status-option scheduled" onclick="selectStatus('scheduled')">
                            üìÖ Scheduled
                        </div>
                        <div class="status-option completed" onclick="selectStatus('completed')">
                            ‚úÖ Completed
                        </div>
                    </div>
                    <div class="score-input-group" id="scoreInputGroup">
                        <div class="form-group">
                            <label class="form-label" for="actualScore">Actual Points Earned:</label>
                            <input type="number" id="actualScore" class="form-input" min="0" required>
                            <small>Default: <span class="current-score" id="defaultScore">0</span> points</small>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="activityNotes">Notes:</label>
                    <textarea id="activityNotes" class="form-textarea" placeholder="Add notes about this activity..."></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('notesModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentWeek = new Date();
        let activities = JSON.parse(localStorage.getItem('activities')) || {};
        let activityGroups = JSON.parse(localStorage.getItem('activityGroups')) || getDefaultGroups();
        let currentView = 'daily'; // Default to daily for mobile
        let editingGroup = null;
        let editingActivity = { groupId: null, activityId: null };
        let editingScheduledActivity = { dateKey: null, activityIndex: null };

        // PWA variables
        let deferredPrompt;
        let isInstalled = false;

        // Device detection
        let deviceType = 'mobile';
        let isTouchDevice = false;

        // Touch drag variables
        let touchItem = null;
        let touchStartPos = { x: 0, y: 0 };
        let isDragging = false;

        // Mobile sidebar functions
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('masterActivities');
            const overlay = document.getElementById('mobileOverlay');
            const toggle = document.getElementById('mobileToggle');

            if (sidebar.classList.contains('open')) {
                closeMobileSidebar();
            } else {
                openMobileSidebar();
            }
        }

        function openMobileSidebar() {
            const sidebar = document.getElementById('masterActivities');
            const overlay = document.getElementById('mobileOverlay');
            const toggle = document.getElementById('mobileToggle');

            sidebar.classList.add('open');
            overlay.classList.add('active');
            toggle.classList.add('open');
            toggle.innerHTML = '√ó';

            // Haptic feedback
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function closeMobileSidebar() {
            const sidebar = document.getElementById('masterActivities');
            const overlay = document.getElementById('mobileOverlay');
            const toggle = document.getElementById('mobileToggle');

            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            toggle.classList.remove('open');
            toggle.innerHTML = '‚ò∞';
        }

        // Default activity groups
        function getDefaultGroups() {
            return {
                'development': {
                    name: 'Development',
                    defaultScore: 20,
                    activities: {
                        'code-review': { name: 'Code Review', score: 20 },
                        'feature-development': { name: 'Feature Development', score: 20 },
                        'bug-fixes': { name: 'Bug Fixes', score: 20 },
                        'testing': { name: 'Testing', score: 20 }
                    }
                },
                'meetings': {
                    name: 'Meetings',
                    defaultScore: 10,
                    activities: {
                        'team-standup': { name: 'Team Standup', score: 10 },
                        'sprint-planning': { name: 'Sprint Planning', score: 10 },
                        'client-meeting': { name: 'Client Meeting', score: 10 },
                        '1-1-meeting': { name: '1:1 Meeting', score: 10 }
                    }
                },
                'documentation': {
                    name: 'Documentation',
                    defaultScore: 15,
                    activities: {
                        'technical-writing': { name: 'Technical Writing', score: 15 },
                        'api-documentation': { name: 'API Documentation', score: 15 },
                        'process-documentation': { name: 'Process Documentation', score: 15 }
                    }
                }
            };
        }

        // Device detection
        function detectDevice() {
            const width = window.innerWidth;
            const userAgent = navigator.userAgent.toLowerCase();

            // Check for touch capability
            isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

            // Check for desktop indicators
            const isDesktopUA = /windows nt|macintosh|linux(?!.*android)|cros/i.test(userAgent);
            const hasMouseCapability = window.matchMedia('(pointer: fine)').matches;
            const hasHoverCapability = window.matchMedia('(hover: hover)').matches;

            // Determine device type
            if (width >= 1024 && (isDesktopUA || hasMouseCapability || hasHoverCapability)) {
                deviceType = 'desktop';
            } else if (width >= 768) {
                deviceType = 'tablet';
            } else {
                deviceType = 'mobile';
            }

            console.log(`Device detected: ${deviceType}, Width: ${width}, Touch: ${isTouchDevice}`);
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('App initializing...');

            detectDevice();
            console.log('Device detection complete');

            // Force render activities first
            console.log('Rendering activity groups...');
            renderActivityGroups();

            // Add a small delay to ensure rendering
            setTimeout(() => {
                console.log('Activities rendered, setting up interactions...');

                // Setup appropriate drag and drop based on device
                if (deviceType === 'desktop') {
                    setupDesktopDragAndDrop();
                } else {
                    setupTouchDragAndDrop();
                }

                generateCalendar();
                updateStats();
                setupModals();
                initializePWA();

                // Set mobile-specific behavior
                if (deviceType === 'mobile' || deviceType === 'tablet') {
                    // Force daily view for mobile
                    currentView = 'daily';
                    switchView('daily');

                    // Hide mobile toggle button on desktop
                    const mobileToggle = document.getElementById('mobileToggle');
                    if (mobileToggle) {
                        mobileToggle.style.display = 'flex';
                    }
                } else {
                    // Desktop behavior
                    currentView = 'weekly';

                    // Hide mobile toggle button on desktop
                    const mobileToggle = document.getElementById('mobileToggle');
                    if (mobileToggle) {
                        mobileToggle.style.display = 'none';
                    }

                    // Show view toggle on desktop
                    const viewToggle = document.querySelector('.view-toggle');
                    if (viewToggle) {
                        viewToggle.style.display = 'flex';
                    }
                }

                // Set today's date in daily view
                document.getElementById('dailyDate').value = new Date().toISOString().split('T')[0];

                // Add resize listener
                window.addEventListener('resize', handleResize);

                console.log('Universal Activity Tracker initialized successfully');

                // Force show activities container
                const activitiesContainer = document.getElementById('activitiesContainer');
                if (activitiesContainer) {
                    console.log('Activities container found:', activitiesContainer.children.length, 'groups');
                } else {
                    console.error('Activities container not found!');
                }
            }, 100);
        });

        function handleResize() {
            const oldDeviceType = deviceType;
            detectDevice();

            if (oldDeviceType !== deviceType) {
                console.log(`Device type changed from ${oldDeviceType} to ${deviceType}`);
                generateCalendar(); // Regenerate calendar for new layout
            }
        }

        // Activity Groups Management - Enhanced
        function renderActivityGroups() {
            const container = document.getElementById('activitiesContainer');
            if (!container) {
                console.error('Activities container not found!');
                return;
            }

            container.innerHTML = '';
            console.log('Rendering activity groups:', Object.keys(activityGroups));

            Object.entries(activityGroups).forEach(([groupId, group]) => {
                console.log(`Rendering group: ${groupId}`, group);

                const groupDiv = document.createElement('div');
                groupDiv.className = 'activity-group';
                groupDiv.innerHTML = `
                    <div class="activity-group-header">
                        <span class="group-name">${group.name}</span>
                        <div class="group-actions">
                            <button class="edit-btn" onclick="editGroup('${groupId}')" title="Edit Group">‚úèÔ∏è</button>
                            <button class="delete-btn" onclick="deleteGroup('${groupId}')" title="Delete Group">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="group-activities" id="group-${groupId}">
                        ${renderGroupActivities(groupId, group.activities)}
                    </div>
                    <button class="add-btn" onclick="addActivity('${groupId}')">+ Add Activity</button>
                `;
                container.appendChild(groupDiv);
            });

            console.log('Activity groups rendered. Container children:', container.children.length);

            // Force visibility if hidden
            if (container.style.display === 'none') {
                container.style.display = 'flex';
            }

            const masterActivities = document.querySelector('.master-activities');
            if (masterActivities && masterActivities.style.display === 'none') {
                masterActivities.style.display = 'block';
            }

            // Force master activities container visibility
            const masterContainer = document.querySelector('.master-activities');
            if (masterContainer) {
                masterContainer.style.display = 'block';
                masterContainer.style.visibility = 'visible';
                masterContainer.style.height = 'auto';
                console.log('Master activities container made visible');
            }
        }

        function renderGroupActivities(groupId, activities) {
            return Object.entries(activities).map(([activityId, activity]) => `
                <div class="activity-item"
                     draggable="${deviceType === 'desktop'}"
                     data-group="${groupId}"
                     data-score="${activity.score}"
                     data-activity="${activity.name}"
                     data-activity-id="${activityId}">
                    <div class="activity-content">
                        <span class="activity-name">${activity.name}</span>
                        <span class="activity-score">${activity.score}pts</span>
                    </div>
                    <div class="activity-actions">
                        <button class="activity-edit-btn" onclick="editActivity('${groupId}', '${activityId}')" title="Edit">‚úèÔ∏è</button>
                        <button class="activity-delete-btn" onclick="deleteActivity('${groupId}', '${activityId}')" title="Delete">√ó</button>
                    </div>
                </div>
            `).join('');
        }

        // Desktop drag and drop (HTML5)
        function setupDesktopDragAndDrop() {
            document.addEventListener('dragstart', function(e) {
                if (e.target.closest('.activity-item')) {
                    const item = e.target.closest('.activity-item');
                    e.dataTransfer.setData('text/plain', JSON.stringify({
                        activity: item.dataset.activity,
                        group: item.dataset.group,
                        score: parseInt(item.dataset.score)
                    }));
                    item.style.opacity = '0.5';
                }
            });

            document.addEventListener('dragend', function(e) {
                if (e.target.closest('.activity-item')) {
                    e.target.closest('.activity-item').style.opacity = '1';
                }
            });

            document.addEventListener('dragover', function(e) {
                const dropTarget = e.target.closest('.day-cell, .drop-zone');
                if (dropTarget) {
                    e.preventDefault();
                }
            });

            document.addEventListener('dragenter', function(e) {
                const dropTarget = e.target.closest('.day-cell, .drop-zone');
                if (dropTarget) {
                    e.preventDefault();
                    dropTarget.classList.add('drag-over');
                }
            });

            document.addEventListener('dragleave', function(e) {
                const dropTarget = e.target.closest('.day-cell, .drop-zone');
                if (dropTarget && !dropTarget.contains(e.relatedTarget)) {
                    dropTarget.classList.remove('drag-over');
                }
            });

            document.addEventListener('drop', function(e) {
                const dropTarget = e.target.closest('.day-cell, .drop-zone');
                if (dropTarget) {
                    e.preventDefault();
                    dropTarget.classList.remove('drag-over');

                    const data = JSON.parse(e.dataTransfer.getData('text/plain'));

                    let dateKey;
                    if (dropTarget.classList.contains('day-cell')) {
                        dateKey = dropTarget.dataset.dateKey;
                    } else if (dropTarget.id === 'dailyDropZone') {
                        dateKey = document.getElementById('dailyDate').value;
                    }

                    if (dateKey) {
                        simulateDrop(data, dateKey);
                    }
                }
            });
        }

        // Touch-based drag and drop for mobile/tablet
        function setupTouchDragAndDrop() {
            document.addEventListener('touchstart', handleTouchStart, { passive: false });
            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('touchend', handleTouchEnd, { passive: false });
        }

        function handleTouchStart(e) {
            const activityItem = e.target.closest('.activity-item');
            if (activityItem && activityItem.closest('.master-activities')) {
                touchItem = activityItem;
                const touch = e.touches[0];
                touchStartPos = {
                    x: touch.clientX,
                    y: touch.clientY
                };
                isDragging = false;

                // Add haptic feedback if available
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
            }
        }

        function handleTouchMove(e) {
            if (touchItem) {
                const touch = e.touches[0];
                const moveDistance = Math.abs(touch.clientX - touchStartPos.x) + Math.abs(touch.clientY - touchStartPos.y);

                if (moveDistance > 15 && !isDragging) {
                    isDragging = true;
                    touchItem.classList.add('dragging');

                    // Show drop zones
                    document.querySelectorAll('.day-cell, .drop-zone').forEach(cell => {
                        cell.classList.add('drag-over');
                    });

                    // Prevent scrolling while dragging
                    e.preventDefault();
                }

                if (isDragging) {
                    e.preventDefault();

                    // Update visual feedback during drag
                    const element = document.elementFromPoint(touch.clientX, touch.clientY);
                    const dropTarget = element?.closest('.day-cell, .drop-zone');

                    document.querySelectorAll('.day-cell, .drop-zone').forEach(cell => {
                        cell.classList.remove('drag-over');
                    });

                    if (dropTarget) {
                        dropTarget.classList.add('drag-over');
                    }
                }
            }
        }

        function handleTouchEnd(e) {
            if (touchItem) {
                // Reset visual feedback
                touchItem.classList.remove('dragging');
                document.querySelectorAll('.day-cell, .drop-zone').forEach(cell => {
                    cell.classList.remove('drag-over');
                });

                if (isDragging) {
                    const touch = e.changedTouches[0];
                    const dropTarget = document.elementFromPoint(touch.clientX, touch.clientY);
                    const dayCell = dropTarget?.closest('.day-cell');
                    const dailyDropZone = dropTarget?.closest('#dailyDropZone');

                    if (dayCell || dailyDropZone) {
                        // Success haptic feedback
                        if (navigator.vibrate) {
                            navigator.vibrate([100, 50, 100]);
                        }

                        // Get activity data
                        const data = {
                            activity: touchItem.dataset.activity,
                            group: touchItem.dataset.group,
                            score: parseInt(touchItem.dataset.score)
                        };

                        let dateKey;
                        if (dayCell) {
                            dateKey = dayCell.dataset.dateKey;
                        } else if (dailyDropZone) {
                            dateKey = document.getElementById('dailyDate').value;
                        }

                        if (dateKey) {
                            simulateDrop(data, dateKey);

                            // Auto-close mobile sidebar after successful drop
                            if (deviceType === 'mobile' || deviceType === 'tablet') {
                                setTimeout(() => {
                                    closeMobileSidebar();
                                }, 500);
                            }
                        }
                    } else {
                        // Failed drop feedback
                        if (navigator.vibrate) {
                            navigator.vibrate(200);
                        }
                        showToast('Drop on a day to add activity');
                    }
                }

                touchItem = null;
                isDragging = false;
            }
        }

        function simulateDrop(data, dateKey) {
            if (!activities[dateKey]) {
                activities[dateKey] = [];
            }

            // Check if activity already exists for this day
            const exists = activities[dateKey].some(activity => activity.activity === data.activity);
            if (!exists) {
                // Add activity as scheduled by default
                const newActivity = {
                    ...data,
                    status: 'scheduled',
                    actualScore: data.score,
                    notes: '',
                    timestamp: new Date().toISOString()
                };

                activities[dateKey].push(newActivity);
                saveActivities();
                generateCalendar();
                updateStats();

                if (currentView === 'daily') {
                    loadDailyView();
                }

                showToast('Activity added successfully!');
            } else {
                showToast('Activity already exists for this day');
            }
        }

        // Calendar generation - responsive
        function generateCalendar() {
            const grid = document.getElementById('calendarGrid');

            if (deviceType === 'desktop') {
                generateDesktopCalendar(grid);
            } else {
                generateMobileCalendar(grid);
            }

            updateWeekDisplay();
        }

        function generateDesktopCalendar(grid) {
            grid.innerHTML = '';

            // Add day headers
            const dayHeaders = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            dayHeaders.forEach(day => {
                const header = document.createElement('div');
                header.className = 'day-header';
                header.textContent = day;
                grid.appendChild(header);
            });

            // Get start of week (Sunday)
            const startOfWeek = new Date(currentWeek);
            startOfWeek.setDate(currentWeek.getDate() - currentWeek.getDay());

            // Generate 7 days
            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                const dayCell = createDesktopDayCell(date);
                grid.appendChild(dayCell);
            }
        }

        function generateMobileCalendar(grid) {
            grid.innerHTML = '';

            // Get start of week (Sunday)
            const startOfWeek = new Date(currentWeek);
            startOfWeek.setDate(currentWeek.getDate() - currentWeek.getDay());

            // Generate 7 days in mobile-friendly format
            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                const dayCell = createMobileDayCell(date);
                grid.appendChild(dayCell);
            }
        }

        function createDesktopDayCell(date) {
            const dayCell = document.createElement('div');
            dayCell.className = 'day-cell';
            const dateKey = date.toISOString().split('T')[0];

            dayCell.dataset.dateKey = dateKey;

            const dayDate = document.createElement('div');
            dayDate.className = 'day-date';
            dayDate.textContent = date.getDate();

            const dayActivities = document.createElement('div');
            dayActivities.className = 'day-activities';

            // Add existing activities
            if (activities[dateKey]) {
                activities[dateKey].forEach((activity, index) => {
                    const activityDiv = createActivityElement(activity, dateKey, index);
                    dayActivities.appendChild(activityDiv);
                });
            }

            dayCell.appendChild(dayDate);
            dayCell.appendChild(dayActivities);

            return dayCell;
        }

        function createMobileDayCell(date) {
            const dayCell = document.createElement('div');
            dayCell.className = 'day-cell';
            const dateKey = date.toISOString().split('T')[0];
            const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

            // Store date key for drop functionality
            dayCell.dataset.dateKey = dateKey;

            const dayHeaderMobile = document.createElement('div');
            dayHeaderMobile.className = 'day-header-mobile';
            dayHeaderMobile.innerHTML = `
                <span>${dayNames[date.getDay()]}</span>
                <span class="day-date-mobile">${date.getDate()}</span>
            `;

            const dayActivities = document.createElement('div');
            dayActivities.className = 'day-activities';

            // Add existing activities
            if (activities[dateKey] && activities[dateKey].length > 0) {
                activities[dateKey].forEach((activity, index) => {
                    const activityDiv = createActivityElement(activity, dateKey, index);
                    dayActivities.appendChild(activityDiv);
                });
            } else {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-calendar';
                emptyState.innerHTML = `
                    <div class="empty-calendar-icon">üìã</div>
                    <div>Drag activities here</div>
                `;
                dayActivities.appendChild(emptyState);
            }

            dayCell.appendChild(dayHeaderMobile);
            dayCell.appendChild(dayActivities);

            return dayCell;
        }

        function createActivityElement(activity, dateKey, index) {
            const activityDiv = document.createElement('div');
            activityDiv.className = `day-activity ${activity.status || 'scheduled'}`;

            const hasNotes = activity.notes && activity.notes.trim().length > 0;
            const displayScore = activity.status === 'completed' ? activity.actualScore : activity.score;

            activityDiv.innerHTML = `
                <div class="activity-content-wrapper">
                    <div class="activity-info">
                        <div class="activity-title">${activity.activity}</div>
                        <div class="activity-meta">
                            <span class="activity-status">${activity.status || 'scheduled'}</span>
                            <span>${displayScore}pts</span>
                        </div>
                    </div>
                    <div class="activity-controls">
                        <button class="control-btn" onclick="openNotesModal('${dateKey}', ${index})" title="Edit Details">üìù</button>
                        <button class="control-btn" onclick="removeActivity('${dateKey}', ${index})" title="Remove">√ó</button>
                    </div>
                </div>
                ${hasNotes ? '<div class="note-indicator">üí¨</div>' : ''}
            `;

            return activityDiv;
        }

        // Modal Management
        function setupModals() {
            // Group form submission
            document.getElementById('groupForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveGroup();
            });

            // Activity form submission
            document.getElementById('activityForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveActivity();
            });

            // Notes form submission
            document.getElementById('notesForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveActivityNotes();
            });

            // Click outside modal to close
            window.addEventListener('click', function(e) {
                if (e.target.className === 'modal') {
                    e.target.style.display = 'none';
                }
            });
        }

        function openGroupModal(groupId = null) {
            editingGroup = groupId;
            const modal = document.getElementById('groupModal');
            const title = document.getElementById('groupModalTitle');
            const nameInput = document.getElementById('groupName');
            const scoreInput = document.getElementById('groupDefaultScore');

            if (groupId) {
                title.textContent = 'Edit Group';
                const group = activityGroups[groupId];
                nameInput.value = group.name;
                scoreInput.value = group.defaultScore;
            } else {
                title.textContent = 'Add New Group';
                nameInput.value = '';
                scoreInput.value = 10;
            }

            modal.style.display = 'block';
            nameInput.focus();
        }

        function openActivityModal(groupId, activityId = null) {
            editingActivity = { groupId, activityId };
            const modal = document.getElementById('activityModal');
            const title = document.getElementById('activityModalTitle');
            const nameInput = document.getElementById('activityName');
            const scoreInput = document.getElementById('activityScore');

            if (activityId) {
                title.textContent = 'Edit Activity';
                const activity = activityGroups[groupId].activities[activityId];
                nameInput.value = activity.name;
                scoreInput.value = activity.score;
            } else {
                title.textContent = 'Add New Activity';
                nameInput.value = '';
                scoreInput.value = activityGroups[groupId].defaultScore;
            }

            modal.style.display = 'block';
            nameInput.focus();
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function saveGroup() {
            const name = document.getElementById('groupName').value.trim();
            const defaultScore = parseInt(document.getElementById('groupDefaultScore').value);

            if (!name) return;

            if (editingGroup) {
                // Edit existing group
                activityGroups[editingGroup].name = name;
                activityGroups[editingGroup].defaultScore = defaultScore;
            } else {
                // Add new group
                const groupId = name.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '');
                activityGroups[groupId] = {
                    name: name,
                    defaultScore: defaultScore,
                    activities: {}
                };
            }

            saveActivityGroups();
            renderActivityGroups();
            closeModal('groupModal');
        }

        function saveActivity() {
            const name = document.getElementById('activityName').value.trim();
            const score = parseInt(document.getElementById('activityScore').value);
            const { groupId, activityId } = editingActivity;

            if (!name || !groupId) return;

            if (activityId) {
                // Edit existing activity
                activityGroups[groupId].activities[activityId] = { name, score };
            } else {
                // Add new activity
                const newActivityId = name.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '');
                activityGroups[groupId].activities[newActivityId] = { name, score };
            }

            saveActivityGroups();
            renderActivityGroups();
            closeModal('activityModal');
        }

        function editGroup(groupId) {
            openGroupModal(groupId);
        }

        function deleteGroup(groupId) {
            if (confirm(`Are you sure you want to delete the "${activityGroups[groupId].name}" group and all its activities?`)) {
                delete activityGroups[groupId];
                saveActivityGroups();
                renderActivityGroups();
            }
        }

        function addActivity(groupId) {
            openActivityModal(groupId);
        }

        function editActivity(groupId, activityId) {
            openActivityModal(groupId, activityId);
        }

        function deleteActivity(groupId, activityId) {
            const activityName = activityGroups[groupId].activities[activityId].name;
            if (confirm(`Are you sure you want to delete "${activityName}"?`)) {
                delete activityGroups[groupId].activities[activityId];
                saveActivityGroups();
                renderActivityGroups();
            }
        }

        // Notes Modal Functions
        function openNotesModal(dateKey, activityIndex) {
            editingScheduledActivity = { dateKey, activityIndex };
            const activity = activities[dateKey][activityIndex];

            const modal = document.getElementById('notesModal');
            const title = document.getElementById('notesModalTitle');
            const notesTextarea = document.getElementById('activityNotes');
            const actualScoreInput = document.getElementById('actualScore');
            const defaultScoreSpan = document.getElementById('defaultScore');

            title.textContent = `${activity.activity} - Details`;
            notesTextarea.value = activity.notes || '';
            actualScoreInput.value = activity.actualScore || activity.score;
            defaultScoreSpan.textContent = activity.score;

            // Set status
            const currentStatus = activity.status || 'scheduled';
            selectStatus(currentStatus);

            modal.style.display = 'block';
            notesTextarea.focus();
        }

        function selectStatus(status) {
            const options = document.querySelectorAll('.status-option');
            const scoreInputGroup = document.getElementById('scoreInputGroup');

            options.forEach(option => {
                option.classList.remove('selected');
                if (option.classList.contains(status)) {
                    option.classList.add('selected');
                }
            });

            // Show score input only for completed activities
            if (status === 'completed') {
                scoreInputGroup.classList.add('active');
            } else {
                scoreInputGroup.classList.remove('active');
            }
        }

        function saveActivityNotes() {
            const { dateKey, activityIndex } = editingScheduledActivity;
            if (!dateKey || activityIndex === null) return;

            const activity = activities[dateKey][activityIndex];
            const notes = document.getElementById('activityNotes').value.trim();
            const actualScore = parseInt(document.getElementById('actualScore').value) || activity.score;
            const selectedStatus = document.querySelector('.status-option.selected');
            const status = selectedStatus ? selectedStatus.classList.contains('completed') ? 'completed' : 'scheduled' : 'scheduled';

            // Update activity
            activity.notes = notes;
            activity.status = status;
            if (status === 'completed') {
                activity.actualScore = actualScore;
            } else {
                activity.actualScore = activity.score; // Reset to default for scheduled
            }

            saveActivities();
            generateCalendar();
            updateStats();

            if (currentView === 'daily') {
                loadDailyView();
            }

            closeModal('notesModal');
        }

        function removeActivity(dateKey, index) {
            activities[dateKey].splice(index, 1);
            if (activities[dateKey].length === 0) {
                delete activities[dateKey];
            }
            saveActivities();
            generateCalendar();
            updateStats();

            if (currentView === 'daily') {
                loadDailyView();
            }
        }

        // Week navigation
        function previousWeek() {
            currentWeek.setDate(currentWeek.getDate() - 7);
            generateCalendar();
        }

        function nextWeek() {
            currentWeek.setDate(currentWeek.getDate() + 7);
            generateCalendar();
        }

        function goToToday() {
            currentWeek = new Date();
            generateCalendar();
        }

        function updateWeekDisplay() {
            const startOfWeek = new Date(currentWeek);
            startOfWeek.setDate(currentWeek.getDate() - currentWeek.getDay());
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(startOfWeek.getDate() + 6);

            const options = { month: 'short', day: 'numeric' };
            const weekText = `${startOfWeek.toLocaleDateString(undefined, options)} - ${endOfWeek.toLocaleDateString(undefined, options)}`;
            document.getElementById('currentWeek').textContent = weekText;
        }

        // View switching - Fixed
        function switchView(view) {
            currentView = view;

            // Get the clicked button properly
            const clickedButton = document.querySelector(`.toggle-btn[onclick="switchView('${view}')"]`);

            document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));
            if (clickedButton) {
                clickedButton.classList.add('active');
            }

            const weeklyView = document.querySelector('.weekly-view');
            const dailyView = document.querySelector('.daily-view');

            if (view === 'weekly') {
                weeklyView.classList.add('active');
                dailyView.classList.remove('active');
                weeklyView.style.display = 'flex';
                dailyView.style.display = 'none';
                console.log('Switched to weekly view');
            } else {
                weeklyView.classList.remove('active');
                dailyView.classList.add('active');
                weeklyView.style.display = 'none';
                dailyView.style.display = 'flex';
                loadDailyView();
                console.log('Switched to daily view');
            }
        }

        // Daily view functionality
        function loadDailyView() {
            const selectedDate = document.getElementById('dailyDate').value;
            const dropZone = document.getElementById('dailyDropZone');
            const summary = document.getElementById('dailySummary');

            // Clear and populate activities
            if (activities[selectedDate] && activities[selectedDate].length > 0) {
                dropZone.classList.add('has-activities');
                dropZone.innerHTML = '';

                activities[selectedDate].forEach((activity, index) => {
                    const activityDiv = createActivityElement(activity, selectedDate, index);
                    dropZone.appendChild(activityDiv);
                });
            } else {
                dropZone.classList.remove('has-activities');
                dropZone.innerHTML = 'Drag activities here for the selected day';
            }

            // Update summary
            updateDailySummary(selectedDate);
        }

        function updateDailySummary(date) {
            const summary = document.getElementById('dailySummary');
            const dayActivities = activities[date] || [];

            if (dayActivities.length === 0) {
                summary.innerHTML = '<p>No activities planned for this day</p>';
                return;
            }

            const groupStats = {};
            let totalScheduledScore = 0;
            let totalCompletedScore = 0;
            let scheduledCount = 0;
            let completedCount = 0;

            dayActivities.forEach(activity => {
                const status = activity.status || 'scheduled';

                if (!groupStats[activity.group]) {
                    groupStats[activity.group] = { scheduled: 0, completed: 0, scheduledScore: 0, completedScore: 0 };
                }

                if (status === 'completed') {
                    groupStats[activity.group].completed++;
                    groupStats[activity.group].completedScore += activity.actualScore || activity.score;
                    totalCompletedScore += activity.actualScore || activity.score;
                    completedCount++;
                } else {
                    groupStats[activity.group].scheduled++;
                    groupStats[activity.group].scheduledScore += activity.score;
                    totalScheduledScore += activity.score;
                    scheduledCount++;
                }
            });

            let summaryHTML = `
                <h4>Daily Summary</h4>
                <div style="margin-bottom: 15px;">
                    <p><strong>Scheduled:</strong> ${scheduledCount} activities (${totalScheduledScore} potential points)</p>
                    <p><strong>Completed:</strong> ${completedCount} activities (${totalCompletedScore} points earned)</p>
                </div>
                <h5>By Category:</h5>
                <ul>
            `;

            Object.entries(groupStats).forEach(([group, stats]) => {
                if (stats.scheduled > 0 || stats.completed > 0) {
                    summaryHTML += `<li><strong>${group}:</strong> `;
                    if (stats.scheduled > 0) {
                        summaryHTML += `${stats.scheduled} scheduled (${stats.scheduledScore}pts)`;
                    }
                    if (stats.completed > 0) {
                        if (stats.scheduled > 0) summaryHTML += ', ';
                        summaryHTML += `${stats.completed} completed (${stats.completedScore}pts)`;
                    }
                    summaryHTML += '</li>';
                }
            });

            summaryHTML += '</ul>';
            summary.innerHTML = summaryHTML;
        }

        // Statistics
        function updateStats() {
            const allDates = Object.keys(activities);
            const daysWorked = allDates.filter(date =>
                activities[date].some(activity => activity.status === 'completed')
            ).length;

            const currentWeekActivities = getCurrentWeekActivities();

            // Calculate stats for completed activities only
            let weeklyCompletedScore = 0;
            let totalCompletedActivities = 0;
            let totalScheduledActivities = 0;

            // Count all activities across all time
            Object.values(activities).forEach(dayActivities => {
                dayActivities.forEach(activity => {
                    if (activity.status === 'completed') {
                        totalCompletedActivities++;
                    } else {
                        totalScheduledActivities++;
                    }
                });
            });

            // Calculate weekly score from current week only
            currentWeekActivities.forEach(dayActivities => {
                dayActivities.forEach(activity => {
                    if (activity.status === 'completed') {
                        weeklyCompletedScore += activity.actualScore || activity.score;
                    }
                });
            });

            document.getElementById('totalDaysWorked').textContent = daysWorked;
            document.getElementById('weeklyCompletedScore').textContent = weeklyCompletedScore;
            document.getElementById('completedActivities').textContent = totalCompletedActivities;
            document.getElementById('scheduledActivities').textContent = totalScheduledActivities;
        }

        function getCurrentWeekActivities() {
            const startOfWeek = new Date(currentWeek);
            startOfWeek.setDate(currentWeek.getDate() - currentWeek.getDay());

            const weekActivities = [];
            for (let i = 0; i < 7; i++) {
                const date = new Date(startOfWeek);
                date.setDate(startOfWeek.getDate() + i);
                const dateKey = date.toISOString().split('T')[0];
                weekActivities.push(activities[dateKey] || []);
            }

            return weekActivities;
        }

        // PWA Functions
        function initializePWA() {
            // Register service worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            }

            // Handle PWA install prompt
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;

                // Show install banner after 3 seconds if not already installed
                setTimeout(() => {
                    if (!isInstalled && !localStorage.getItem('installBannerDismissed')) {
                        showInstallBanner();
                    }
                }, 3000);
            });

            // Handle app installed
            window.addEventListener('appinstalled', (evt) => {
                console.log('App installed');
                isInstalled = true;
                hideInstallBanner();
            });

            // Check if app is already installed
            if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
                isInstalled = true;
            }
        }

        function showInstallBanner() {
            const banner = document.getElementById('installBanner');
            banner.classList.add('show');
        }

        function hideInstallBanner() {
            const banner = document.getElementById('installBanner');
            banner.classList.remove('show');
        }

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                        isInstalled = true;
                    }
                    deferredPrompt = null;
                    hideInstallBanner();
                });
            } else {
                // Fallback for browsers that don't support the install prompt
                alert('To install this app:\n\n1. On iOS: Tap Share button ‚Üí Add to Home Screen\n2. On Android: Tap menu ‚Üí Add to Home Screen\n3. On Desktop: Look for install icon in address bar');
                hideInstallBanner();
            }
        }

        function dismissInstallBanner() {
            hideInstallBanner();
            localStorage.setItem('installBannerDismissed', 'true');
        }

        function showToast(message) {
            // Simple toast notification
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #28a745;
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                z-index: 10000;
                font-size: 14px;
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                max-width: 300px;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Local storage
        function saveActivities() {
            localStorage.setItem('activities', JSON.stringify(activities));
        }

        function saveActivityGroups() {
            localStorage.setItem('activityGroups', JSON.stringify(activityGroups));
        }
    </script>
</body>
</html>